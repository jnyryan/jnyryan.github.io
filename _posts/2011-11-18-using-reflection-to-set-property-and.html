---
title: "Using Reflection to set Property and Field values"
layout: "post"
permalink: "/2011/11/using-reflection-to-set-property-and.html"
uuid: "1292172880875155966"
guid: "tag:blogger.com,1999:blog-6842749499040869174.post-1292172880875155966"
date: "2011-11-18 14:23:00"
updated: "2011-12-01 15:23:42"
description: 
blogger:
    siteid: "6842749499040869174"
    postid: "1292172880875155966"
    comments: "0"
categories: playing-with-technology
tags: [C#]
author: 
    name: "Johnny"
    url: "http://www.blogger.com/profile/05733316879665781472?rel=author"
    image: "http://img2.blogblog.com/img/b16-rounded.gif"
---

<div class="css-full-post-content js-full-post-content">
<span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">When dealing with legacy code I find it invaluable to have a way of accessing provate internal members to write. Here's some very handy code that will do just that. And for goo measure, i've included some unit tests.</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">///////////////////////////////////////////////////////////////////////////////////////////////////</span><br /><span class="Apple-style-span" style="font-size: x-small;">// Subtext WebLog</span><br /><span class="Apple-style-span" style="font-size: x-small;">//&nbsp;</span><br /><span class="Apple-style-span" style="font-size: x-small;">// Subtext is an open source weblog system that is a fork of the .TEXT</span><br /><span class="Apple-style-span" style="font-size: x-small;">// weblog system.</span><br /><span class="Apple-style-span" style="font-size: x-small;">//</span><br /><span class="Apple-style-span" style="font-size: x-small;">// For updated news and information please visit http://subtextproject.com/</span><br /><span class="Apple-style-span" style="font-size: x-small;">// Subtext is hosted at SourceForge at http://sourceforge.net/projects/subtext</span><br /><span class="Apple-style-span" style="font-size: x-small;">// The development mailing list is at subtext-devs@lists.sourceforge.net&nbsp;</span><br /><span class="Apple-style-span" style="font-size: x-small;">//</span><br /><span class="Apple-style-span" style="font-size: x-small;">// This project is licensed under the BSD license. &nbsp;See the License.txt file for more information.</span><br /><span class="Apple-style-span" style="font-size: x-small;">///////////////////////////////////////////////////////////////////////////////////////////////////</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">using System;</span><br /><span class="Apple-style-span" style="font-size: x-small;">using System.Reflection;</span><br /><span class="Apple-style-span" style="font-size: x-small;">using Components.Infrastructure.Common;</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">namespace Common.ReflectionHelper</span><br /><span class="Apple-style-span" style="font-size: x-small;">{</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp;///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp;/// Helper class to simplify common reflection tasks.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp;///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp;public static class ReflectionHelper</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp;{</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// Sets the value of the private static member.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; public static void SetStaticFieldValue(string fieldName, Type type, T value)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;FieldInfo field = type.GetField(fieldName, BindingFlags.NonPublic | BindingFlags.Static);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;if (field == null)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; throw new ArgumentException(string.Format("Could not find the private instance field '{0}'", fieldName));</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;field.SetValue(null, value);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// Sets the value of the private static member.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; public static void SetStaticFieldValue(string fieldName, string typeName, T value)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;Type type = Type.GetType(typeName, true);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;FieldInfo field = type.GetField(fieldName, BindingFlags.NonPublic | BindingFlags.Static);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;if (field == null)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; throw new ArgumentException(string.Format("Could not find the private instance field '{0}'", fieldName));</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;field.SetValue(null, value);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// Returns the value of the private member specified.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// Name of the member.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// Type of the member.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; public static T GetStaticFieldValue(string fieldName, Type type)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;FieldInfo field = type.GetField(fieldName, BindingFlags.NonPublic | BindingFlags.Static);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;if (field != null)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;{</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; return (T)field.GetValue(type);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;}</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;return default(T);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// Returns the value of the private member specified.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// Name of the member.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; public static T GetStaticFieldValue(string fieldName, string typeName)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;Type type = Type.GetType(typeName, true);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;FieldInfo field = type.GetField(fieldName, BindingFlags.NonPublic | BindingFlags.Static);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;if (field != null)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;{</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; return (T)field.GetValue(type);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;}</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;return default(T);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// Sets the value of the private member specified.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// Name of the member.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// The object that contains the member.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// The value to set the member to.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; public static void SetPrivateInstanceFieldValue(string memberName, object source, object value)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;FieldInfo field = source.GetType().GetField(memberName, BindingFlags.GetField | BindingFlags.NonPublic | BindingFlags.Instance);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;if (field == null)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; throw new ArgumentException(string.Format("Could not find the private instance field '{0}'", memberName));</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;field.SetValue(source, value);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; /// Sets the value of the private member specified.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; /// Name of the property.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; /// The object that contains the property.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; /// The value to set the property to.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; public static void SetPrivateInstancePropertyValue(string propName, object source, object value)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PropertyInfo property = source.GetType().GetProperty(propName, BindingFlags.GetField | BindingFlags.NonPublic | BindingFlags.Instance);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (property == null)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new ArgumentException(string.Format("Could not find the private instance property '{0}'", propName));</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; property.SetValue(source, value, BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.SetProperty | BindingFlags.Instance, null, null, null);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// Returns the value of the private member specified.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// Name of the member.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// The object that contains the member.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; public static object GetStaticField(string fieldName, object source)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;return GetStaticField(fieldName, source, source.GetType());</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// Returns the value of the private member specified.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// Name of the member.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// The object that contains the member.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; public static object GetStaticField(string fieldName, object source, Type type)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;FieldInfo field = type.GetField(fieldName, BindingFlags.NonPublic | BindingFlags.Static);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;if(field != null)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;{</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; return field.GetValue(type);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;}</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;return null;</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// Returns the value of the private member specified.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// Name of the member.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; /// The object that contains the member.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; public static object GetPrivateInstanceField(string memberName, object source)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;FieldInfo field = source.GetType().GetField(memberName, BindingFlags.GetField | BindingFlags.NonPublic | BindingFlags.Instance);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;if(field != null)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;{</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; return field.GetValue(source);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;}</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp;return null;</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; /// Returns the value of the private member specified.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; ///</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; /// Name of the member.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; /// The object that contains the member.</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; public static object GetPrivateInstanceProperty(string propName, object source)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PropertyInfo prop = source.GetType().GetProperty(propName, BindingFlags.GetProperty | BindingFlags.NonPublic | BindingFlags.Instance);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (prop != null)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return prop.GetValue(source, BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.SetProperty | BindingFlags.Instance, null, null, null);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return null;</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; public static object RunStaticMethod(Type t, string strMethod, object[] objParams)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BindingFlags eFlags = BindingFlags.Static | BindingFlags.Public | BindingFlags.NonPublic;</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return RunMethod(t, strMethod, null, objParams, eFlags);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; public static object RunInstanceMethod(Type t, string strMethod, object objInstance, object[] aobjParams)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BindingFlags eFlags = BindingFlags.Instance | BindingFlags.Public |</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BindingFlags.NonPublic;</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return RunMethod(t, strMethod, objInstance, aobjParams, eFlags);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; private static object RunMethod(Type t, string strMethod, object objInstance, object[] objParams,</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BindingFlags eFlags)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MethodInfo m = t.GetMethod(strMethod, eFlags);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (m == null)</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new ArgumentException("There is no method '" + strMethod + "' for type '" + t + "'.");</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; object objRet = m.Invoke(objInstance, objParams);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return objRet;</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp;}</span><br /><span class="Apple-style-span" style="font-size: x-small;">}</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><br /><br /><span class="Apple-style-span" style="font-size: x-small;">///////////////////////////////////////////////////////////////////////////////////////////////////</span><br /><span class="Apple-style-span" style="font-size: x-small;">// Unit Test&nbsp;</span><br /><br /><span class="Apple-style-span" style="font-size: x-small;">///////////////////////////////////////////////////////////////////////////////////////////////////</span><br /><div><span class="Apple-style-span" style="font-size: x-small;"><br /></span></div><br /><br /><span class="Apple-style-span" style="font-size: x-small;">namespace &nbsp;Common.UnitTests.ReflectionHelper {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; internal class TestClass</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; private string myField = "This is my initial value"; &nbsp; &nbsp; &nbsp; &nbsp; private String MyProperty</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; get { return myField; }</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set { myField = value; }</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; [TestFixture]</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; public class ReflectionHelperTests</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; [Test]</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; public void PrivateInstanceFieldsTest()</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var testValue = "This is my new Value";</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var myTestClass = new TestClass();</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var result = ReflectionHelper.GetPrivateInstanceField("myField", myTestClass);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReflectionHelper.SetPrivateInstanceFieldValue("myField", myTestClass, testValue);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result = ReflectionHelper.GetPrivateInstanceField("myField", myTestClass);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Assert.AreEqual(testValue, result);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; [Test]</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; public void PrivateInstancePropertyTest()</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; {</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var testValue = "This is my new Value";</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var myTestClass = new TestClass();</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReflectionHelper.SetPrivateInstancePropertyValue("MyProperty", myTestClass, testValue);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var result = ReflectionHelper.GetPrivateInstanceProperty("MyProperty", myTestClass);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Assert.AreEqual(testValue, result);</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;">&nbsp; &nbsp; }</span><br /><span class="Apple-style-span" style="font-size: x-small;">}</span><br /><div><span class="Apple-style-span" style="font-size: x-small;"><br /></span></div><br />
</div>